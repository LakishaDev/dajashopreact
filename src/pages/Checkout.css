/* --- LAYOUT --- */
.checkout-page {
  padding-bottom: 60px;
}

.checkout-title {
  font-size: clamp(1.8rem, 4vw, 2.5rem);
  font-weight: 800;
  margin-bottom: 24px;
  color: var(--text);
}

.checkout-layout {
  display: grid;
  grid-template-columns: 1.6fr 1fr; /* Forma je šira */
  gap: 24px;
  align-items: start;
}

/* --- SECTIONS (Left) --- */
.checkout-section {
  padding: 24px;
  margin-bottom: 20px;
  background: rgba(255, 255, 255, 0.02); /* Malo tamnije od surface */

  /* FIX: Stacking context - mora biti relativan i vidljiv */
  position: relative;
  z-index: 1;
  overflow: visible !important;
}

/* FIX: Podizanje sekcije kada je dropdown otvoren */
.checkout-section.z-high {
  z-index: 50 !important;
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

.section-header h2 {
  font-size: 1.25rem;
  margin: 0;
  font-weight: 700;
}

.step-badge {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: var(--primary);
  color: var(--on-primary);
  font-weight: 800;
  display: grid;
  place-items: center;
  font-size: 0.9rem;
}

/* src/pages/Checkout.css */

/* --- FORM INPUTS --- */
.form-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.input-group {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
}

.input-group.full-width {
  grid-column: 1 / -1;
}

/* IKONICA: Apsolutno pozicionirana, centrirana vertikalno */
.input-icon {
  position: absolute;
  left: 16px; /* Malo veći razmak od ivice za eleganciju */
  color: var(--muted);
  pointer-events: none;
  transition: color 0.2s ease, transform 0.2s ease;
  z-index: 10; /* Osiguravamo da je iznad input pozadine */
}

/* GENERALNI STIL ZA SVE INPUTE */
.checkout-section input {
  width: 100%;
  height: 52px; /* Fiksna visina za konzistentnost (Apple style) */
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.1); /* Suptilniji border */
  background: rgba(0, 0, 0, 0.2); /* Tamnija, modernija pozadina */
  color: var(--text);
  font-size: 1rem;
  font-weight: 500;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

  /* DEFAULT PADDING (za polja bez ikonice, npr. Grad) */
  padding: 0 16px;
}

/* SPECIFIČNO: Input koji ima ikonicu ispred sebe */
/* Ovo je ključni fix: Selektujemo input koji je direktni sledbenik ikonice */
.input-group .input-icon + input {
  padding-left: 40px !important; /* 16px (left) + 24px (icon space) + 10px (gap) */
}

/* HOVER STATE */
.checkout-section input:hover {
  border-color: rgba(255, 255, 255, 0.2);
  background: rgba(0, 0, 0, 0.25);
}

/* FOCUS STATE */
.checkout-section input:focus {
  outline: none;
  border-color: var(--primary);
  background: rgba(0, 0, 0, 0.3);
  box-shadow: 0 0 0 4px color-mix(in oklab, var(--primary), transparent 85%);
  transform: translateY(-1px); /* Suptilan lift efekat */
}

/* Focus-within na grupi boji i ikonicu */
.input-group:focus-within .input-icon {
  color: var(--primary);
  transform: scale(1.1); /* Mali pop efekat ikonice */
}
/* --- RADIO CARDS --- */
.radio-card {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.08);
  background: rgba(255, 255, 255, 0.02);
  cursor: pointer;
  transition: all 0.2s ease;
  margin-bottom: 12px;
  position: relative;
  overflow: hidden;
}

.radio-card:hover {
  background: rgba(255, 255, 255, 0.04);
}

.radio-card.selected {
  border-color: var(--primary);
  background: color-mix(in oklab, var(--primary), transparent 92%);
}

.radio-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.radio-title {
  display: block;
  font-weight: 700;
  color: var(--text);
  font-size: 1rem;
}

.radio-desc {
  display: block;
  font-size: 0.8rem;
  color: var(--muted);
  margin-top: 2px;
}

.radio-price {
  font-weight: 700;
  margin-right: 12px;

  /* --- NOVO: FIX ZA PORAVNANJE --- */
  text-align: right; /* Tekst se lepi desno (bliže kvačici) */
  min-width: 120px; /* Rezerviše isti prostor i za cenu i za reč "Besplatna" */
  margin-left: auto; /* Gura cenu skroz desno od naslova */
  padding-right: 20px;
}
.text-success {
  color: #40a840;
  font-weight: 700;
}
.text-primary {
  color: var(--primary);
}

.radio-check {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid var(--muted);
  display: grid;
  place-items: center;
  color: transparent;
  transition: all 0.2s;
}

.radio-card.selected .radio-check {
  border-color: var(--primary);
  background: var(--primary);
  color: var(--on-primary);
}

/* --- RIGHT COLUMN (Summary) --- */
.summary-card {
  position: sticky;
  top: 100px; /* Da prati skrol */
  padding: 24px;
}

.summary-card h2 {
  font-size: 1.3rem;
  margin: 0 0 20px 0;
  font-weight: 700;
}

.summary-rows {
  display: grid;
  gap: 12px;
  margin-bottom: 24px;
}

.summary-row {
  display: flex;
  justify-content: space-between;
  font-size: 1rem;
}

.summary-total {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 800;
  font-size: 1.2rem;
  margin-top: 12px;
}

.total-price {
  font-size: 1.8rem;
  color: var(--primary);
}

.checkout-btn {
  width: 100%;
  padding: 16px;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 16px;
  border-radius: 12px;
  transition: transform 0.1s;
}
.checkout-btn:active {
  transform: scale(0.98);
}

.secure-badge {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  color: #40a840;
  font-size: 0.85rem;
  opacity: 0.8;
}

/* =========================================
   MOBILE RESPONSIVE
   ========================================= */
@media (max-width: 900px) {
  .checkout-layout {
    grid-template-columns: 1fr; /* Jedna kolona */
    gap: 16px;
  }
  .summary-card {
    position: static;
  }
}

@media (max-width: 480px) {
  .form-grid {
    grid-template-columns: 1fr; /* Inputi jedan ispod drugog */
  }
  .checkout-section {
    padding: 16px;
  }
  .radio-info {
    gap: 10px;
  }
  .radio-title {
    font-size: 0.95rem;
  }
}

/* =========================================
   ERROR STATES (Validacija)
   ========================================= */

.input-group.input-error input {
  border-color: #ef4444 !important;
  background: rgba(239, 68, 68, 0.05);
  box-shadow: 0 0 0 1px #ef4444 inset;
}

.input-group.input-error .input-icon {
  color: #ef4444;
}

.error-icon {
  position: absolute;
  right: 14px;
  color: #ef4444;
  pointer-events: none;
  animation: fadeIn 0.2s ease;
}

.error-msg {
  display: block;
  font-size: 0.8rem;
  color: #ef4444;
  font-weight: 600;
  margin-top: 4px;
  margin-left: 4px;
  animation: slideDown 0.2s ease forwards;
}

.input-group.input-error input:focus {
  box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2);
  border-color: #ef4444;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.8);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* =========================================
   NOVO: Z-INDEX FIXES & EMAIL DROPDOWN
   ========================================= */

.relative-wrapper {
  position: relative;
}

/* Podizanje wrappera da bude iznad inputa ispod */
.relative-wrapper.z-50 {
  z-index: 100;
}

/* Dropdown Stil */
.email-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%; /* Sada prati širinu input-group-a */

  z-index: 1000;

  margin-top: 6px;
  background: var(--color-surface, #151923);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 12px;
  /* Jaka senka da se odvoji od pozadine */
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);

  list-style: none;
  padding: 4px;
  max-height: 220px;
  overflow-y: auto;
  animation: slideDown 0.15s ease-out forwards;
}

.email-dropdown li {
  padding: 10px 14px;
  border-radius: 8px;
  cursor: pointer;
  color: var(--color-text, #fff);
  font-size: 0.95rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.15s;
}

.email-dropdown li:hover {
  background: var(--color-primary, #c8a94e);
  color: #000;
}

.email-dropdown .domain {
  opacity: 0.6;
  font-size: 0.85em;
}
.email-dropdown li:hover .domain {
  opacity: 0.8;
  color: #000;
}

/* Google Places Styling */
.pac-container {
  background-color: #151923;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
  font-family: inherit;
  margin-top: 6px;
  z-index: 2000;
}
.pac-item {
  border-top: none;
  padding: 10px 14px;
  cursor: pointer;
  color: #ececec;
}
.pac-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.pac-item-query {
  color: #fff;
  font-weight: 700;
}
.pac-item span {
  color: #9ca3af;
}
.pac-logo:after {
  filter: invert(1) opacity(0.5);
  margin: 8px 12px;
}
/* ... (postojeći kod za Checkout.css) ... */

/* === FIX ZA PREKLAPANJE SEKCIJA (Z-INDEX FIX) === */

/* Osnovno stanje za sve sekcije - mora biti relative */
.checkout-section {
  position: relative;
  z-index: 1;
  overflow: visible !important;
}

/* Kada je dropdown otvoren, dižemo celu sekciju iznad sledeće */
.checkout-section.z-high {
  z-index: 50 !important;
}

/* Email wrapper mora biti relativan i imati viši z-index unutar forme */
.relative-wrapper {
  position: relative;
}

/* Podizanje wrappera da bude iznad inputa ispod */
.relative-wrapper.z-50 {
  z-index: 100;
}

/* --- ORDER CONFIRMATION MODAL --- */

.order-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999; /* Mora biti najviši */
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display: grid;
  place-items: center;
  padding: 16px;
}

.order-card {
  width: 100%;
  max-width: 600px;
  padding: 30px;
  position: relative;
  border-radius: 20px;

  /* --- NOVO ZA SKROL --- */
  max-height: 85vh; /* Ograničimo visinu da bi se pojavio skrol */
  overflow-y: auto; /* Dozvoljavamo vertikalni skrol */
  overscroll-behavior: contain; /* SPREČAVA povlačenje pozadine (chaining) */

  /* Lepši scrollbar (opciono, ali preporučeno) */
  scrollbar-width: thin;
  scrollbar-color: var(--primary) rgba(0, 0, 0, 0.1);

  display: flex;
  flex-direction: column;
}

/* Webkit scrollbar stilizacija (Chrome, Safari, Edge) */
.order-card::-webkit-scrollbar {
  width: 6px;
}
.order-card::-webkit-scrollbar-track {
  background: transparent;
}
.order-card::-webkit-scrollbar-thumb {
  background-color: var(--muted);
  border-radius: 20px;
  border: 2px solid transparent;
  background-clip: content-box;
}
.order-card::-webkit-scrollbar-thumb:hover {
  background-color: var(--primary);
}
.order-header {
  text-align: center;
  margin-bottom: 24px;
}

.text-success-ico {
  color: #40a840;
  margin-inline: auto;
  margin-bottom: 8px;
  font-weight: 800;
}

.order-header h2 {
  font-size: 1.8rem;
  font-weight: 800;
  margin: 0 0 8px;
  color: var(--text);
}

.order-lead {
  font-size: 1rem;
  color: var(--muted);
  line-height: 1.5;
}
/* ... (Sav postojeći CSS) ... */

/* =========================================
   NOVO: Z-INDEX FIXES & EMAIL DROPDOWN
   ========================================= */

/* ... (postojeći CSS za dropdown i z-index) ... */

/* --- ORDER CONFIRMATION MODAL & RECEIPT STYLES --- */

/* Stil za dugme Prikaži na mapi u okviru Računa */
.btn-map-receipt {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  /* Koristimo dark/glass stilove */
  background: rgba(255, 255, 255, 0.08);
  color: var(--color-primary, #c8a94e);
  border: 1px solid var(--color-primary, #c8a94e);
  margin-top: 10px;
  font-weight: 700;
  font-size: 0.9rem;
  transition: background 0.2s, color 0.2s, transform 0.1s;
}
.btn-map-receipt:hover {
  background: var(--color-primary, #c8a94e);
  color: var(--color-bg); /* Obrnuti kontrast */
  transform: translateY(-1px);
}

.order-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display: grid;
  place-items: center;
  padding: 16px;
}

.order-card {
  width: 100%;
  max-width: 600px;
  padding: 30px;
  position: relative;
  border-radius: 20px;
}

.order-header {
  text-align: center;
  margin-bottom: 24px;
}

.text-success-ico {
  color: #40a840;
  margin-inline: auto;
  margin-bottom: 8px;
  font-weight: 800;
}

.order-header h2 {
  font-size: 1.8rem;
  font-weight: 800;
  margin: 0 0 8px;
  color: var(--text);
}

.order-lead {
  font-size: 1rem;
  color: var(--muted);
  line-height: 1.5;
}

/* --- RECEIPT DETAILS --- */

.receipt-details {
  padding: 24px;
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.04);
  border: 1px dashed rgba(255, 255, 255, 0.1);
}

.details-title {
  font-size: 1.1rem;
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.item-list {
  display: grid;
  gap: 12px;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.item-row {
  display: grid;
  grid-template-columns: 2fr auto 1fr;
  gap: 10px;
  align-items: baseline;
  font-size: 0.95rem;
}

.item-name {
  font-weight: 600;
  color: var(--text);
}

.item-qty {
  color: var(--muted);
  font-size: 0.85rem;
}

.item-price {
  font-weight: 700;
  justify-self: end;
}

/* Summary */
.summary-section {
  display: grid;
  gap: 8px;
}

.summary-section .summary-row {
  font-size: 1rem;
}

.summary-section .summary-row.total {
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--primary);
  margin-top: 8px;
}

.summary-section .hr {
  height: 1px;
  background: rgba(255, 255, 255, 0.15);
  margin: 10px 0;
}

/* Delivery Info */
.delivery-info {
  margin-top: 20px;
  padding-top: 16px;
  border-top: 1px dashed rgba(255, 255, 255, 0.1);
  color: var(--muted);
  font-size: 0.9rem;
}

.delivery-info h4 {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text);
  margin: 0 0 8px;
}

.delivery-info p {
  margin: 4px 0;
}

/* Actions */
.order-actions {
  margin-top: 30px;
  text-align: center;
}

.order-actions .checkout-btn {
  display: inline-flex;
  gap: 10px;
  align-items: center;
  padding: 14px 24px;
  font-size: 1rem;
  border-radius: 12px;
}

/* Mobile Adjustments */
@media (max-width: 520px) {
  .order-card {
    padding: 20px;
  }
  .order-header h2 {
    font-size: 1.4rem;
  }
  .receipt-details {
    padding: 16px;
  }
  .summary-section .summary-row.total {
    font-size: 1.3rem;
  }
}
/* ... (Sav postojeći CSS iz prethodnih koraka) ... */

/* === IFRAME MAP STYLES === */

/* Kontejner za responzivni iframe (4:3 aspect ratio) */
.map-container {
  position: relative;
  width: 100%;
  padding-top: 75%; /* 4:3 Aspect Ratio (3 / 4 * 100) */
  background: var(--color-bg);
}
.map-container iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
  border-top: 1px solid rgba(255, 255, 255, 0.1); /* Separator od teksta adrese */
}

/* Uklanjamo stil starog linka/dugmeta koji je sada nepotreban, 
   ali ostavljamo stil za dugme unutar receipt modala (.btn-map-receipt) */

/* ... (Ostatak CSS-a za .btn-map-receipt, .pac-container, itd. ostaje nepromenjen) ... */
/* src/pages/Checkout.css */

/* --- REGISTRATION POPOUT (NOTIFICATION STYLE) --- */

.reg-popover {
  position: relative;
  width: 100%;
  margin-top: 24px; /* Odvaja ga od forme */

  /* Tamna pozadina koja se ističe na staklu */
  background: #18181b;
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 16px;
  padding: 20px;

  /* Jaka senka da izgleda kao da lebdi iznad */
  box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
  z-index: 10;

  /* Animacija ulaska */
  transform-origin: top left;
  animation: popin 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

/* STRELICA NA VRHU (Arrow Tip) */
.reg-popover::before {
  content: "";
  position: absolute;
  top: -8px; /* Izađe malo iznad */
  left: 32px; /* Poravnato sa inputima */
  width: 16px;
  height: 16px;

  /* Mora biti iste boje kao pozadina popovera */
  background: #18181b;

  /* Iste ivice kao popover */
  border-top: 1px solid rgba(255, 255, 255, 0.12);
  border-left: 1px solid rgba(255, 255, 255, 0.12);

  /* Rotacija da napravi trougao */
  transform: rotate(45deg);
}

/* Header sa naslovom i X dugmetom */
.reg-popover-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
}

.reg-popover-title {
  color: #fff;
  font-weight: 700;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 8px;
}

.reg-popover-desc {
  color: #a1a1aa;
  font-size: 0.85rem;
  margin-top: 4px;
  line-height: 1.4;
}

/* X Dugme */
.reg-close-btn {
  background: rgba(255, 255, 255, 0.05);
  border: none;
  color: #71717a;
  cursor: pointer;
  padding: 6px;
  border-radius: 8px;
  transition: all 0.2s;
  display: grid;
  place-items: center;
}
.reg-close-btn:hover {
  background: rgba(255, 255, 255, 0.15);
  color: #fff;
}

/* Input za lozinku */
.reg-popover input {
  background: rgba(0, 0, 0, 0.3) !important;
  border-color: rgba(255, 255, 255, 0.15) !important;
  color: #fff !important;
  font-size: 0.95rem;
  height: 46px;
  border-radius: 10px;
  width: 100%;
  padding-left: 42px; /* Mesto za ikonicu */
}
.reg-popover input:focus {
  border-color: var(--primary) !important;
  background: rgba(0, 0, 0, 0.5) !important;
  box-shadow: 0 0 0 2px rgba(200, 169, 78, 0.2);
}

/* Dugme Potvrdi */
.reg-confirm-btn {
  width: 100%;
  margin-top: 16px;
  padding: 12px;
  border-radius: 12px;
  border: none;
  background: var(--primary);
  color: #000;
  font-weight: 800;
  font-size: 0.95rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: transform 0.1s, filter 0.2s;
}
.reg-confirm-btn:hover {
  filter: brightness(1.1);
}
.reg-confirm-btn:active {
  transform: scale(0.98);
}

@keyframes popin {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* --- ERROR STYLES --- */

/* Stil za Input grupu kada ima grešku */
.input-group.input-error {
  border-color: #ef4444 !important; /* Jaka crvena boja */
  box-shadow: 0 0 0 1px #ef4444 !important; /* Crveni glow efekat */
  border-radius: 12px !important; /* Dodat border radius kako si tražio */
  background-color: rgba(254, 242, 242, 0.5); /* Blago crvena pozadina */
}

/* Ikonica unutar inputa postaje crvena */
.input-group.input-error .input-icon {
  color: #ef4444 !important;
}

/* Tekst unutar inputa */
.input-group.input-error input {
  color: #b91c1c; /* Tamnije crvena za tekst koji kucaš */
}

/* Poruka greške (Popout) - Osiguravamo da je crvena */
.custom-error-popout {
  display: flex;
  align-items: center;
  gap: 8px;
  background: #fef2f2;
  border: 1px solid #fca5a5;
  color: #dc2626 !important; /* Jaka crvena slova */
  font-weight: 500;
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 0.85rem;
  overflow: hidden;
  margin-top: 6px;
  box-shadow: 0 2px 6px rgba(239, 68, 68, 0.15);
}

.custom-error-popout span {
  color: #dc2626 !important;
}

.error-icon-pop {
  color: #dc2626 !important;
}

/* Animacija trzanja (Shake) ako želiš da dodaš */
@keyframes shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-4px);
  }
  75% {
    transform: translateX(4px);
  }
}

.input-group.input-error {
  animation: shake 0.3s ease-in-out;
}
/* --- FIX ZA DROPDOWN I Z-INDEX --- */

.flag-dropdown {
  /* Osigurava da je dropdown iznad svega ostalog u toj sekciji */
  z-index: 9999 !important;
}

/* Pomaže Lenis-u da razume skrolovanje unutar dropdowna */
.country-dropdown-scroll {
  overscroll-behavior: contain;
}

/* REŠENJE ZA PREKLAPANJE KARTICA (Z-Index Context) */

/* Sve sekcije moraju imati relative position da bi z-index radio */
.checkout-section {
  position: relative;
}

/* Prva kartica (Info) mora biti IZNAD druge (Isporuka) da dropdown ne bi otišao ispod */
.checkout-left .checkout-section:nth-of-type(1) {
  z-index: 20;
}

.checkout-left .checkout-section:nth-of-type(2) {
  z-index: 10;
}

.checkout-left .checkout-section:nth-of-type(3) {
  z-index: 5;
}
